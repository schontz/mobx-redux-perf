(this["webpackJsonpmobx-redux-perf"]=this["webpackJsonpmobx-redux-perf"]||[]).push([[0],{15:function(e,t,n){},21:function(e,t,n){},29:function(e,t,n){"use strict";n.r(t);var o=n(0),c=n.n(o),r=n(4),i=n.n(r),s=(n(21),n(5)),d=(n(15),n(13)),u=n(9),l=n.n(u),a=n(10),b=n(11),j=n(2),h=n(30),f=n(1);function g(){var e="every good boy does fine please excuse my dear aunt susy".split(" ");return new Array(7).fill("").map((function(){return e[O(e.length-1)]})).join(" ")}function O(e){return Math.round(Math.random()*e)}var x=function(){var e=Object(o.useRef)(1);return Object(o.useEffect)((function(){e.current++})),Object(f.jsx)("div",{className:"count-render",children:e.current})},p=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object(h.a)();Object(a.a)(this,e),this.title=t,this.done=n,this.id=o,Object(j.e)(this)}return Object(b.a)(e,[{key:"toggleDone",value:function(){this.setDone(!this.done)}},{key:"setDone",value:function(e){this.done=e}},{key:"setTitle",value:function(e){this.title=e}}]),e}(),v=new(function(){function e(){Object(a.a)(this,e),this.todos=[],this.loading=!1,Object(j.e)(this)}return Object(b.a)(e,[{key:"pendingTodos",get:function(){return this.todos.filter((function(e){return!e.done}))}},{key:"addTodo",value:function(e){this.todos.push(e)}},{key:"removeTodo",value:function(e){this.todos.splice(e,1)}},{key:"clearAll",value:function(){this.todos=[]}},{key:"findTodo",value:function(e){return this.todos.find((function(t){return t.id===e}))}},{key:"loadFromServer",value:l.a.mark((function e(){var t,n=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,this.clearAll(),e.next=4,new Promise((function(e){setTimeout((function(){e(new Array(1e3).fill(0).map((function(){return{title:g(),id:Object(h.a)(),done:O(2)>1}})))}),O(1e3))}));case 4:t=e.sent,console.log("received data from server:",t),t.forEach((function(e){var t=e.title,o=e.done,c=e.id;n.addTodo(new p(t,o,c))})),this.loading=!1;case 8:case"end":return e.stop()}}),e,this)}))}]),e}());function m(e){var t,n;"number"===typeof e?null===(t=v.todos[e])||void 0===t||t.toggleDone():null===(n=v.findTodo(e))||void 0===n||n.toggleDone()}var T=!1,y=function(){if(T=!T){var e=Object(j.b)((function(){T&&(console.group("running updates"),new Array(25).fill(0).forEach((function(){var e=-1;switch(O(4)){case 0:e=O(v.todos.length),console.log("updating title at",e,"/",v.todos.length),function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g();null===(t=v.todos[e])||void 0===t||t.setTitle(n)}(e,g());break;case 1:e=O(v.todos.length),console.log("toggling done at",e,"/",v.todos.length),m(e);break;case 2:v.todos.length>7&&(e=O(v.todos.length),console.log("removing at",e,"/",v.todos.length),function(e){v.removeTodo(e)}(e),console.count("change length"));break;case 3:console.log("adding new item"),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g(),t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];v.addTodo(new p(e,t))}(g(),O(2)>1),v.addTodo(new p(g(),O(2)>1)),console.count("change length")}})),console.groupEnd(),setTimeout(e,50+O(150)))}));e()}},k=Object(d.a)((function(e){var t=e.todo;return Object(f.jsxs)("li",{className:t.done?"completed":"",onClick:function(){return m(t.id)},children:[t.title," ",Object(f.jsx)(x,{})]})})),w=Object(d.a)((function(e){var t=e.store,n=Object(o.useState)(!1),c=Object(s.a)(n,2),r=c[0],i=c[1],d=r?t.pendingTodos:t.todos;return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("h3",{children:"mobx: Re-rendering long lists"}),Object(f.jsx)("p",{children:"mobx allows fine-grain updates, which only re-render the necessary components."}),Object(f.jsxs)("p",{children:["Source:"," ",Object(f.jsx)("a",{href:"https://github.com/schontz/mobx-redux-perf/blob/master/src/AppMobx.tsx",children:"AppMobx.tsx"}),"| ",Object(f.jsx)("a",{href:"https://github.com/schontz/mobx-redux-perf/blob/master/src/mobx.tsx",children:"mobx.tsx"})]}),Object(f.jsxs)("div",{children:["Render count: ",Object(f.jsx)(x,{}),"\xa0 | \xa0 Total items: ",d.length," / ",t.todos.length,"\xa0 | \xa0",Object(f.jsxs)("label",{children:[Object(f.jsx)("input",{type:"checkbox",onChange:function(e){return i(e.target.checked)}})," Hide completed?"]}),"\xa0 | \xa0 Simulate server:"," ",Object(f.jsx)("button",{onClick:y,children:"toggle streaming"})," ",Object(f.jsx)("button",{onClick:function(){return t.loadFromServer()},disabled:t.loading,children:"one-time"})]}),t.loading?Object(f.jsx)("div",{children:"Loading..."}):Object(f.jsx)("ul",{children:d.map((function(e){return Object(f.jsx)(k,{todo:e},e.id)}))})]})}));var S=function(){return Object(o.useEffect)((function(){v.loadFromServer()}),[]),Object(f.jsx)(w,{store:v})},A=n(3),E=n(14),R=n(6),C=Object(E.b)({name:"todos",initialState:{todos:{}},reducers:{addTodo:function(e,t){var n=t.payload,o=n.title,c=n.done,r=Object(h.a)();e.todos[r]={id:r,title:null!==o&&void 0!==o?o:g(),done:null!==c&&void 0!==c&&c}},removeTodo:function(e,t){var n=t.payload;delete e.todos[n]},toggleTodo:function(e,t){var n=t.payload,o=e.todos[n];o?o.done=!o.done:console.error("toggleTodo: no todo found",n)},clearTodos:function(e){e.todos={}},updateTodo:function(e,t){var n=t.payload,o=n.id,c=n.title,r=e.todos[o];r?r.title=c:console.error("updateTodo: no todo found",o)}}}),F=function(e){return e.todoList},L=Object(R.a)(F,(function(e){return Object.values(e.todos)})),D=Object(R.a)(F,(function(e){return Object.keys(e.todos)})),M=(Object(R.a)(L,(function(e){return e.filter((function(e){return e.done}))})),Object(R.a)(L,(function(e){return e.filter((function(e){return!e.done}))}))),z=Object(R.a)(M,(function(e){return e.map((function(e){return e.id}))})),N=Object(E.a)({reducer:{todoList:C.reducer}}),P=C.actions,B=P.toggleTodo,H=P.addTodo,I=P.clearTodos,J=P.removeTodo,q=P.updateTodo,G=c.a.memo((function(e){var t=e.id,n=Object(A.d)(function(e){return function(t){return t.todoList.todos[e]}}(t)),o=Object(A.c)();return Object(f.jsxs)("li",{className:n.done?"completed":"",onClick:function(){return o(B(n.id))},children:[n.title," ",Object(f.jsx)(x,{})]})})),K=function(){var e=Object(o.useState)(!1),t=Object(s.a)(e,2),n=t[0],c=t[1],r=Object(o.useState)(!1),i=Object(s.a)(r,2),d=i[0],u=i[1],l=Object(A.d)(D),a=Object(A.d)(z),b=n?a:l;return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("h3",{children:"Redux: Re-rendering long lists"}),Object(f.jsx)("p",{children:"Redux re-renders the whole list."}),Object(f.jsxs)("p",{children:["Source:"," ",Object(f.jsx)("a",{href:"https://github.com/schontz/mobx-redux-perf/blob/master/src/AppRedux.tsx",children:"AppRedux.tsx"}),"|"," ",Object(f.jsx)("a",{href:"https://github.com/schontz/mobx-redux-perf/blob/master/src/redux.tsx",children:"redux.tsx"})]}),Object(f.jsxs)("div",{children:["Render count: ",Object(f.jsx)(x,{}),"\xa0 | \xa0 Total items: ",b.length," / ",b.length,"\xa0 | \xa0",Object(f.jsxs)("label",{children:[Object(f.jsx)("input",{type:"checkbox",onChange:function(e){return c(e.target.checked)}})," Hide completed?"]}),"\xa0 | \xa0",Object(f.jsx)("button",{onClick:function(){return u(!d)},children:"Simulate remote updates"})]}),b.length?Object(f.jsx)("ul",{children:b.map((function(e){return Object(f.jsx)(G,{id:e},e)}))}):Object(f.jsx)("div",{children:"Loading..."}),d&&Object(f.jsx)(Q,{})]})},Q=function(){var e=Object(A.c)(),t=Object(A.d)(D),n=Object(o.useState)(!1),c=Object(s.a)(n,2),r=c[0],i=c[1],d=Object(o.useRef)();return Object(o.useEffect)((function(){return clearTimeout(d.current),d.current=setTimeout((function(){return Object(A.b)((function(){console.group("running updates");var n=t.length;new Array(25).fill(0).forEach((function(){var o=-1;switch(O(4)){case 0:o=O(n),console.log("updating title at",o,"/",t.length),e(q({id:t[o],title:g()}));break;case 1:o=O(n),console.log("toggling done at",o,"/",t.length),e(B(t[o]));break;case 2:t.length>7&&(o=O(n),console.log("removing at",o,"/",t.length),e(J(t[o])),console.count("change length"),n--);break;case 3:console.log("adding new item"),e(H({title:g(),done:O(2)>1})),console.count("change length")}})),console.groupEnd(),i(!r)}))}),50+O(150)),function(){return clearTimeout(d.current)}}),[e,t,r]),null};function U(){var e=Object(A.c)();return Object(o.useEffect)((function(){var t=setTimeout((function(){Object(A.b)((function(){new Array(1e3).fill(0).forEach((function(){e(H({title:g(),done:O(2)>1}))}))}))}),O(1e3));return function(){clearTimeout(t),e(I())}}),[e]),null}var V=function(){return Object(f.jsxs)(A.a,{store:N,children:[Object(f.jsx)(U,{}),Object(f.jsx)(K,{})]})},W=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,31)).then((function(t){var n=t.getCLS,o=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),o(e),c(e),r(e),i(e)}))};i.a.render(Object(f.jsx)(c.a.StrictMode,{children:Object(f.jsxs)("div",{style:{display:"flex"},children:[Object(f.jsx)("div",{style:{width:"50%",padding:"10px",borderRight:"1px solid"},children:Object(f.jsx)(S,{})}),Object(f.jsx)("div",{style:{width:"50%",padding:"10px"},children:Object(f.jsx)(V,{})})]})}),document.getElementById("root")),W()}},[[29,1,2]]]);
//# sourceMappingURL=main.0a62fadd.chunk.js.map